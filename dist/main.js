(()=>{"use strict";const t=(t,e)=>{return{length:(i=t,i<1?1:i>5?5:i),name:e,hits:[],hit(t){this.hits.every((e=>e.toString()!==t))&&this.hits.push(t)},isSunk(){return this.hits.length===this.length}};var i};let e=10;function i(t,i){let r=document.createElement("div");r.setAttribute("id",t.toString()),r.classList.add("gameboard-div"),i.appendChild(r);for(let t=1;t<=e;t++)for(let i=1;i<=e;i++){let e=document.createElement("div");e.classList.add("gameboard-tile"),e.setAttribute("data-value",[i,t]),r.appendChild(e)}return r}function r(t,e,i,r){let s=document.createElement(e);return s.classList.add(t),s.textContent=r,i.appendChild(s),s}function s(t,i,r,s){let a=parseInt(i[0]),n=parseInt(i[1]);if(0==t){let t=a+(r.length-1)>=e?11-a:r.length;for(let e=0;e<t;e++){let t=document.querySelector(`[data-value="${a+e},${n}"]`);"add"===s?t.classList.add("hover"):"remove"===s&&t.classList.remove("hover")}}}function a(t,e){let i=!0;return e.forEach((e=>{t.indexOf(e)>-1&&(i=!1)})),i}function n(t,e){this.ship=t,this.position=e}const l=()=>{let t=[];return{gameboard:t,missedShots:[],placeShip(t,e,i){if(!1===function(t,e,i,r){if(i){if(e[1]+(t.length-1)>10||e[1]+(t.length-1)<1)return!1;let i=[];for(let r=0;r<t.length;r++)i.push(`[${e[0]}, ${e[1]+r}]`);return a(r,i)}if(e[0]+(t.length-1)>10||e[0]+(t.length-1)<1)return!1;let s=[];for(let i=0;i<t.length;i++)s.push([e[0]+i,e[1]].toString());return a(r,s)}(t,e,i,this.gameboard.map((t=>t.position.toString()))))return!1;if(i){for(let i=0;i<t.length;i++){let r=new n(t,[e[0],e[1]+i]);this.gameboard.push(r)}return!0}for(let i=0;i<t.length;i++){let r=new n(t,[e[0]+i,e[1]]);this.gameboard.push(r)}return!0},recieveAttack(e){let i=this.gameboard.find((t=>t.position.toString()==e.toString())),r=this.gameboard.indexOf(i);if(-1!==r)return t[r].ship.hit(e),t[r].ship.hits;this.recieveMissedHit(e)},recieveMissedHit(t){-1!==this.missedShots.findIndex((e=>e.toString()===t.toString()))||this.missedShots.push(t)},checkAllShipsSunk:()=>t.reduce(((t,e)=>(t.find((t=>t.name===e.ship.name))?e.times++:(e.times=1,t.push(e.ship)),t)),[]).every((t=>!0===t.isSunk()))}};function o(t,e){return Math.floor(Math.random()*(e-t+1)+t)}console.log("working");let h=document.querySelector("body"),u={createStartGameMenu(t){let e=r("start-menu-div","div",t),s=(r("welcome-text","div",e,"Welcome to Battleships"),r("place-text","div",e));r("place-text-p","p",s,"Place your"),r("place-current","p",s),r("rotate-button","button",e,"Rotate"),i("place-ship-gameboard",e)},createShips(e){e.ships.push(t(5,"Carrier")),e.ships.push(t(4,"Battleship")),e.ships.push(t(3,"Cruiser")),e.ships.push(t(3,"Carrier")),e.ships.push(t(2,"Destroyer"))},enableShipPlacing(t,e=[],r=0){let a=document.querySelector(".place-current"),n=document.querySelectorAll(".gameboard-tile"),l=document.querySelector("#place-ship-gameboard"),o=document.querySelector(".start-menu-div"),h=document.querySelector(".rotate-button"),u=!1;for(h.addEventListener("click",(()=>{u=0==u})),e.push(t.ships[0]);e.length>0&&r<5;){e.shift();let h=t.ships[r];a.textContent=h.name,n.forEach((a=>{a.addEventListener("mouseover",(()=>{let t=a.getAttribute("data-value").split(",");s(u,t,h,"add")})),a.addEventListener("mouseout",(()=>{let t=a.getAttribute("data-value").split(",");s(u,t,h,"remove")})),a.addEventListener("click",(()=>{let s=a.getAttribute("data-value").split(",");s=[parseInt(s[0]),parseInt(s[1])],1==t.gameboard.placeShip(h,s,u)&&(r+=1,e.push(t.ships[r]),l.remove(),i("place-ship-gameboard",o),this.enableShipPlacing(t,e,r))}))}))}5===r&&console.log(!0)}};u.createStartGameMenu(h);let c={name:"player1",ships:[],gameboard:l(),passAttacks:[],attack(t,e){if(this.checkAlreadyHit(t))return!1;this.passAttacks.push(t),e.recieveAttack(t)},randomAttack(t){let e=o(1,10),i=o(1,10),r=[e,i];for(;this.checkAlreadyHit(r);)e=o(1,10),i=o(1,10),r=[e,i];return this.attack(r,t),o(1,10)},checkAlreadyHit(t){return-1!==this.passAttacks.findIndex((e=>e.toString()===t.toString()))}};u.createShips(c),u.enableShipPlacing(c)})();